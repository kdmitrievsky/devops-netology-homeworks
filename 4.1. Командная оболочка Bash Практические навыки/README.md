## 4.1. Командная оболочка Bash Практические навыки  

1. Есть скрипт:
```
a=1
b=2
c=a+b
d=$a+$b
e=$(($a+$b))
```  
Какие значения переменным c,d,e будут присвоены? Почему?  
Ответ:  
*с = "a+b"* - т.к. не указано что a и b это переменные и bash интерпритирует это по-умолчаниюкак текст  
*d = "1+2"* - т.к. значения переменных подставляются, но это всё равно текст для bash  
*e = "3"* - здесь и значения переменных подставляются и скобки для вычисления есть.  
  
2. На нашем локальном сервере упал сервис и мы написали скрипт, который постоянно проверяет его доступность, записывая дату проверок до тех пор, пока сервис не станет доступным (после чего скрипт должен завершиться). В скрипте допущена ошибка, из-за которой выполнение не может завершиться, при этом место на Жёстком Диске постоянно уменьшается. Что необходимо сделать, чтобы его исправить:
```
while ((1==1)
do
	curl https://localhost:4757
	if (($? != 0))
	then
		date >> curl.log
	fi
done  
``` 
Ответ:  
```
while ((1==1)) # Не хватало закрытой скобки в бесконечном цикле
do
	curl https://localhost:4757
	if (($? != 0))
	then
		date >> curl.log
	else 
	    exit # Выходим если сервис одуплился)
	fi
done  
```  
3. Необходимо написать скрипт, который проверяет доступность трёх IP: 192.168.0.1, 173.194.222.113, 87.250.250.242 по 80 порту и записывает результат в файл log. Проверять доступность необходимо пять раз для каждого узла.  
Ответ:  
```  
targets=(192.168.0.1 173.194.222.113 87.250.250.242)
for i in {1..5} # Запускаем 5 циклов
do
    for host in ${targets[@]} # Перебираем хосты
    do
	    curl -Is --connect-timeout 5 $host:80 >/dev/null # Проверяем доступность
            echo date "check" $host status=$? >>targets.log # Пишем в лог
    done
done
```  
4. Необходимо дописать скрипт из предыдущего задания так, чтобы он выполнялся до тех пор, пока один из узлов не окажется недоступным. Если любой из узлов недоступен - IP этого узла пишется в файл error, скрипт прерывается.  
Ответ:  
```  
targets=(192.168.0.1 173.194.222.113 87.250.250.242)
result=0
while (($result==0)) # Запускаем цикл "Пока доступны"
do
    for host in ${targets[@]} # Перебираем хосты
    do
	    curl -Is --connect-timeout 5 $host:80 >/dev/null
	    result=$?
	    if (($result != 0)) # Проверяем результат доступности
	    then
            echo $host >>error # Хост недоступен - пишем в error
            exit # Прерываем for
        else # Хост доступен
            echo date "check" $host status=$result >>targets.log # Пишем в лог
        fi
    done
done
```
